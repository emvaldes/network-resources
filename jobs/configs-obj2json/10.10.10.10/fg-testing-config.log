+ oIFS=' 	
'
+ for xitem in "${@}"
+ IFS==
+ read -r key value
++ echo -e --search=10.10.10.10
++ sed -e '1s|^\(-\)\{1,\}||'
+ [[ search =~ ^(search|s)$ ]]
+ local target_pattern=10.10.10.10
+ [[ search =~ ^(source|o)$ ]]
+ [[ search =~ ^(target|t)$ ]]
+ [[ search =~ ^(logger|l)$ ]]
+ [[ search == \d\e\b\u\g ]]
+ [[ search == \d\r\y\-\r\u\n ]]
+ [[ search == \v\e\r\b\o\s\e ]]
+ for xitem in "${@}"
+ IFS==
+ read -r key value
++ echo -e '--source=config firewall policy--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--  edit 13--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--   set name "Remote NAT"--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--   set srcintf "dmz"--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--   set dstintf "wan1"--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--   set srcaddr "10.10.10.10"--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--   set dstaddr "203.0.113.10"--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--   set action accept--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--   set logtraffic all--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--  next--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--end'
++ sed -e '1s|^\(-\)\{1,\}||'
+ [[ source =~ ^(search|s)$ ]]
+ [[ source =~ ^(source|o)$ ]]
+ local 'source_object=config firewall policy--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--  edit 13--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--   set name "Remote NAT"--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--   set srcintf "dmz"--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--   set dstintf "wan1"--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--   set srcaddr "10.10.10.10"--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--   set dstaddr "203.0.113.10"--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--   set action accept--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--   set logtraffic all--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--  next--ZGV2b3BzLXJlc291cmNlcy5zaGVsbA--end'
+ [[ source =~ ^(target|t)$ ]]
+ [[ source =~ ^(logger|l)$ ]]
+ [[ source == \d\e\b\u\g ]]
+ [[ source == \d\r\y\-\r\u\n ]]
+ [[ source == \v\e\r\b\o\s\e ]]
+ for xitem in "${@}"
+ IFS==
+ read -r key value
++ echo -e --target=/var/folders/vp/4k9xy96d7zx8lhmgrr4khsj80000gn/T/tmp.90hwuJyGl8/fg-testing-config.list.objects
++ sed -e '1s|^\(-\)\{1,\}||'
+ [[ target =~ ^(search|s)$ ]]
+ [[ target =~ ^(source|o)$ ]]
+ [[ target =~ ^(target|t)$ ]]
+ local target_object=/var/folders/vp/4k9xy96d7zx8lhmgrr4khsj80000gn/T/tmp.90hwuJyGl8/fg-testing-config.list.objects
+ [[ target =~ ^(logger|l)$ ]]
+ [[ target == \d\e\b\u\g ]]
+ [[ target == \d\r\y\-\r\u\n ]]
+ [[ target == \v\e\r\b\o\s\e ]]
+ for xitem in "${@}"
+ IFS==
+ read -r key value
++ echo -e --logger=/var/folders/vp/4k9xy96d7zx8lhmgrr4khsj80000gn/T/tmp.90hwuJyGl8/configs-obj2json--10.10.10.10--fortinet--fg-testing-config.console
++ sed -e '1s|^\(-\)\{1,\}||'
+ [[ logger =~ ^(search|s)$ ]]
+ [[ logger =~ ^(source|o)$ ]]
+ [[ logger =~ ^(target|t)$ ]]
+ [[ logger =~ ^(logger|l)$ ]]
+ local target_console=/var/folders/vp/4k9xy96d7zx8lhmgrr4khsj80000gn/T/tmp.90hwuJyGl8/configs-obj2json--10.10.10.10--fortinet--fg-testing-config.console
+ [[ logger == \d\e\b\u\g ]]
+ [[ logger == \d\r\y\-\r\u\n ]]
+ [[ logger == \v\e\r\b\o\s\e ]]
+ IFS=' 	
'
+ [[ -z true ]]
+ [[ -z false ]]
+ [[ -z true ]]
+ local target_console=console/configs-obj2json.console
+ mapfile -t restored_block
++ printf '%s\n' 'config firewall policy
  edit 13
   set name "Remote NAT"
   set srcintf "dmz"
   set dstintf "wan1"
   set srcaddr "10.10.10.10"
   set dstaddr "203.0.113.10"
   set action accept
   set logtraffic all
  next
end'
+ local 'object_header=config firewall policy'
+ local object_keyword type_value partner_value
+ read -a header_tokens
+ object_keyword=config
+ [[ config == \c\o\n\f\i\g ]]
++ printf '%s ' firewall policy
++ sed 's/[[:space:]]*$//'
+ type_value='firewall policy'
+ partner_value=false
+ data_sets=()
+ local -a data_sets
+ local description_value=false
+ for line in "${restored_block[@]}"
++ sed -E 's/^[[:space:]]*//;s/[[:space:]]*$//'
+ local 'trimmed=config firewall policy'
+ [[ -z config firewall policy ]]
+ [[ config firewall policy =~ ^description[[:space:]] ]]
+ [[ config firewall policy =~ ^edit[[:space:]]+".+" ]]
+ [[ config firewall policy =~ ^set[[:space:]]+comment[[:space:]] ]]
+ [[ config firewall policy == \n\e\x\t ]]
+ [[ config firewall policy == \e\n\d ]]
+ data_sets+=("${trimmed}")
+ for line in "${restored_block[@]}"
++ sed -E 's/^[[:space:]]*//;s/[[:space:]]*$//'
+ local 'trimmed=edit 13'
+ [[ -z edit 13 ]]
+ [[ edit 13 =~ ^description[[:space:]] ]]
+ [[ edit 13 =~ ^edit[[:space:]]+".+" ]]
+ [[ edit 13 =~ ^set[[:space:]]+comment[[:space:]] ]]
+ [[ edit 13 == \n\e\x\t ]]
+ [[ edit 13 == \e\n\d ]]
+ data_sets+=("${trimmed}")
+ for line in "${restored_block[@]}"
++ sed -E 's/^[[:space:]]*//;s/[[:space:]]*$//'
+ local 'trimmed=set name "Remote NAT"'
+ [[ -z set name "Remote NAT" ]]
+ [[ set name "remote nat" =~ ^description[[:space:]] ]]
+ [[ set name "remote nat" =~ ^edit[[:space:]]+".+" ]]
+ [[ set name "remote nat" =~ ^set[[:space:]]+comment[[:space:]] ]]
+ [[ set name "remote nat" == \n\e\x\t ]]
+ [[ set name "remote nat" == \e\n\d ]]
+ data_sets+=("${trimmed}")
+ for line in "${restored_block[@]}"
++ sed -E 's/^[[:space:]]*//;s/[[:space:]]*$//'
+ local 'trimmed=set srcintf "dmz"'
+ [[ -z set srcintf "dmz" ]]
+ [[ set srcintf "dmz" =~ ^description[[:space:]] ]]
+ [[ set srcintf "dmz" =~ ^edit[[:space:]]+".+" ]]
+ [[ set srcintf "dmz" =~ ^set[[:space:]]+comment[[:space:]] ]]
+ [[ set srcintf "dmz" == \n\e\x\t ]]
+ [[ set srcintf "dmz" == \e\n\d ]]
+ data_sets+=("${trimmed}")
+ for line in "${restored_block[@]}"
++ sed -E 's/^[[:space:]]*//;s/[[:space:]]*$//'
+ local 'trimmed=set dstintf "wan1"'
+ [[ -z set dstintf "wan1" ]]
+ [[ set dstintf "wan1" =~ ^description[[:space:]] ]]
+ [[ set dstintf "wan1" =~ ^edit[[:space:]]+".+" ]]
+ [[ set dstintf "wan1" =~ ^set[[:space:]]+comment[[:space:]] ]]
+ [[ set dstintf "wan1" == \n\e\x\t ]]
+ [[ set dstintf "wan1" == \e\n\d ]]
+ data_sets+=("${trimmed}")
+ for line in "${restored_block[@]}"
++ sed -E 's/^[[:space:]]*//;s/[[:space:]]*$//'
+ local 'trimmed=set srcaddr "10.10.10.10"'
+ [[ -z set srcaddr "10.10.10.10" ]]
+ [[ set srcaddr "10.10.10.10" =~ ^description[[:space:]] ]]
+ [[ set srcaddr "10.10.10.10" =~ ^edit[[:space:]]+".+" ]]
+ [[ set srcaddr "10.10.10.10" =~ ^set[[:space:]]+comment[[:space:]] ]]
+ [[ set srcaddr "10.10.10.10" == \n\e\x\t ]]
+ [[ set srcaddr "10.10.10.10" == \e\n\d ]]
+ data_sets+=("${trimmed}")
+ for line in "${restored_block[@]}"
++ sed -E 's/^[[:space:]]*//;s/[[:space:]]*$//'
+ local 'trimmed=set dstaddr "203.0.113.10"'
+ [[ -z set dstaddr "203.0.113.10" ]]
+ [[ set dstaddr "203.0.113.10" =~ ^description[[:space:]] ]]
+ [[ set dstaddr "203.0.113.10" =~ ^edit[[:space:]]+".+" ]]
+ [[ set dstaddr "203.0.113.10" =~ ^set[[:space:]]+comment[[:space:]] ]]
+ [[ set dstaddr "203.0.113.10" == \n\e\x\t ]]
+ [[ set dstaddr "203.0.113.10" == \e\n\d ]]
+ data_sets+=("${trimmed}")
+ for line in "${restored_block[@]}"
++ sed -E 's/^[[:space:]]*//;s/[[:space:]]*$//'
+ local 'trimmed=set action accept'
+ [[ -z set action accept ]]
+ [[ set action accept =~ ^description[[:space:]] ]]
+ [[ set action accept =~ ^edit[[:space:]]+".+" ]]
+ [[ set action accept =~ ^set[[:space:]]+comment[[:space:]] ]]
+ [[ set action accept == \n\e\x\t ]]
+ [[ set action accept == \e\n\d ]]
+ data_sets+=("${trimmed}")
+ for line in "${restored_block[@]}"
++ sed -E 's/^[[:space:]]*//;s/[[:space:]]*$//'
+ local 'trimmed=set logtraffic all'
+ [[ -z set logtraffic all ]]
+ [[ set logtraffic all =~ ^description[[:space:]] ]]
+ [[ set logtraffic all =~ ^edit[[:space:]]+".+" ]]
+ [[ set logtraffic all =~ ^set[[:space:]]+comment[[:space:]] ]]
+ [[ set logtraffic all == \n\e\x\t ]]
+ [[ set logtraffic all == \e\n\d ]]
+ data_sets+=("${trimmed}")
+ for line in "${restored_block[@]}"
++ sed -E 's/^[[:space:]]*//;s/[[:space:]]*$//'
+ local trimmed=next
+ [[ -z next ]]
+ [[ next =~ ^description[[:space:]] ]]
+ [[ next =~ ^edit[[:space:]]+".+" ]]
+ [[ next =~ ^set[[:space:]]+comment[[:space:]] ]]
+ [[ next == \n\e\x\t ]]
+ continue
+ for line in "${restored_block[@]}"
++ sed -E 's/^[[:space:]]*//;s/[[:space:]]*$//'
+ local trimmed=end
+ [[ -z end ]]
+ [[ end =~ ^description[[:space:]] ]]
+ [[ end =~ ^edit[[:space:]]+".+" ]]
+ [[ end =~ ^set[[:space:]]+comment[[:space:]] ]]
+ [[ end == \n\e\x\t ]]
+ [[ end == \e\n\d ]]
+ continue
+ [[ config firewall policy == \c\o\n\f\i\g\ \f\i\r\e\w\a\l\l\ \p\o\l\i\c\y ]]
+ data_sets=("${data_sets[@]:1}")
+ items=()
+ local -a items
+ others=()
+ local -a others
+ for line in "${data_sets[@]}"
+ grep -Eq '(^|[^0-9.])10\.10\.10\.10([^0-9.]|$)'
+ others+=("$(sed -E 's/^[[:space:]]+//;s/[[:space:]]+$//' <<< "${line}")")
++ sed -E 's/^[[:space:]]+//;s/[[:space:]]+$//'
+ for line in "${data_sets[@]}"
+ grep -Eq '(^|[^0-9.])10\.10\.10\.10([^0-9.]|$)'
+ others+=("$(sed -E 's/^[[:space:]]+//;s/[[:space:]]+$//' <<< "${line}")")
++ sed -E 's/^[[:space:]]+//;s/[[:space:]]+$//'
+ for line in "${data_sets[@]}"
+ grep -Eq '(^|[^0-9.])10\.10\.10\.10([^0-9.]|$)'
+ others+=("$(sed -E 's/^[[:space:]]+//;s/[[:space:]]+$//' <<< "${line}")")
++ sed -E 's/^[[:space:]]+//;s/[[:space:]]+$//'
+ for line in "${data_sets[@]}"
+ grep -Eq '(^|[^0-9.])10\.10\.10\.10([^0-9.]|$)'
+ others+=("$(sed -E 's/^[[:space:]]+//;s/[[:space:]]+$//' <<< "${line}")")
++ sed -E 's/^[[:space:]]+//;s/[[:space:]]+$//'
+ for line in "${data_sets[@]}"
+ grep -Eq '(^|[^0-9.])10\.10\.10\.10([^0-9.]|$)'
+ items+=("$(sed -E 's/^[[:space:]]+//;s/[[:space:]]+$//' <<< "${line}")")
++ sed -E 's/^[[:space:]]+//;s/[[:space:]]+$//'
+ for line in "${data_sets[@]}"
+ grep -Eq '(^|[^0-9.])10\.10\.10\.10([^0-9.]|$)'
+ others+=("$(sed -E 's/^[[:space:]]+//;s/[[:space:]]+$//' <<< "${line}")")
++ sed -E 's/^[[:space:]]+//;s/[[:space:]]+$//'
+ for line in "${data_sets[@]}"
+ grep -Eq '(^|[^0-9.])10\.10\.10\.10([^0-9.]|$)'
+ others+=("$(sed -E 's/^[[:space:]]+//;s/[[:space:]]+$//' <<< "${line}")")
++ sed -E 's/^[[:space:]]+//;s/[[:space:]]+$//'
+ for line in "${data_sets[@]}"
+ grep -Eq '(^|[^0-9.])10\.10\.10\.10([^0-9.]|$)'
+ others+=("$(sed -E 's/^[[:space:]]+//;s/[[:space:]]+$//' <<< "${line}")")
++ sed -E 's/^[[:space:]]+//;s/[[:space:]]+$//'
++ printf '%s\n' 'set srcaddr "10.10.10.10"'
++ jq -R .
++ jq --slurp .
+ local 'items_json=[
  "set srcaddr \"10.10.10.10\""
]'
++ printf '%s\n' 'edit 13' 'set name "Remote NAT"' 'set srcintf "dmz"' 'set dstintf "wan1"' 'set dstaddr "203.0.113.10"' 'set action accept' 'set logtraffic all'
++ sed '/^[[:space:]]*$/d'
++ jq -R .
++ jq --slurp .
+ local 'others_json=[
  "edit 13",
  "set name \"Remote NAT\"",
  "set srcintf \"dmz\"",
  "set dstintf \"wan1\"",
  "set dstaddr \"203.0.113.10\"",
  "set action accept",
  "set logtraffic all"
]'
+ local group_value=Unclassified
+ [[ true == true ]]
+ local object_key
++ awk '{print $NF}'
++ sed -E 's/[[:punct:]]*$//'
+ object_key=policy
++ jq -r --arg key policy 'map( select( .match[]? | contains( $key ) ) ) | .[0].group'
+ group_value=null
+ [[ -z null ]]
+ [[ null == \n\u\l\l ]]
++ jq -r --arg desc false 'map( select( .match[]? == $desc ) ) | .[0].group'
+ group_value=null
+ [[ -z null ]]
+ [[ null == \n\u\l\l ]]
+ group_value=Unclassified
++ jq -n --arg object config --arg type 'firewall policy' --arg partner false --arg description false --argjson items '[
  "set srcaddr \"10.10.10.10\""
]' --argjson others '[
  "edit 13",
  "set name \"Remote NAT\"",
  "set srcintf \"dmz\"",
  "set dstintf \"wan1\"",
  "set dstaddr \"203.0.113.10\"",
  "set action accept",
  "set logtraffic all"
]' --arg group Unclassified '{
          object: $object,
          type: ( $type // false ),
          partner: ( $partner | select(. != "" and . != "null" and . != "false") // false ),
          description: ( $description | select(. != "" and . != "null" and . != "false") // false ),
          items: $items,
          others: $others,
          group: $group
        }'
+ local 'target_json={
  "object": "config",
  "type": "firewall policy",
  "partner": false,
  "description": false,
  "items": [
    "set srcaddr \"10.10.10.10\""
  ],
  "others": [
    "edit 13",
    "set name \"Remote NAT\"",
    "set srcintf \"dmz\"",
    "set dstintf \"wan1\"",
    "set dstaddr \"203.0.113.10\"",
    "set action accept",
    "set logtraffic all"
  ],
  "group": "Unclassified"
}'
+ [[ true == true ]]
+ newline
+ local count=1
+ (( i = 0 ))
+ (( i < count ))
+ echo
+ (( i++ ))
+ (( i < count ))
+ for object in "${restored_block[@]}"
+ message 'config firewall policy'
+ [[ -n config firewall policy ]]
+ local 'message=config firewall policy'
+ echo -e 'config firewall policy'
+ for object in "${restored_block[@]}"
+ message '  edit 13'
+ [[ -n   edit 13 ]]
+ local 'message=  edit 13'
+ echo -e '  edit 13'
+ for object in "${restored_block[@]}"
+ message '   set name "Remote NAT"'
+ [[ -n    set name "Remote NAT" ]]
+ local 'message=   set name "Remote NAT"'
+ echo -e '   set name "Remote NAT"'
+ for object in "${restored_block[@]}"
+ message '   set srcintf "dmz"'
+ [[ -n    set srcintf "dmz" ]]
+ local 'message=   set srcintf "dmz"'
+ echo -e '   set srcintf "dmz"'
+ for object in "${restored_block[@]}"
+ message '   set dstintf "wan1"'
+ [[ -n    set dstintf "wan1" ]]
+ local 'message=   set dstintf "wan1"'
+ echo -e '   set dstintf "wan1"'
+ for object in "${restored_block[@]}"
+ message '   set srcaddr "10.10.10.10"'
+ [[ -n    set srcaddr "10.10.10.10" ]]
+ local 'message=   set srcaddr "10.10.10.10"'
+ echo -e '   set srcaddr "10.10.10.10"'
+ for object in "${restored_block[@]}"
+ message '   set dstaddr "203.0.113.10"'
+ [[ -n    set dstaddr "203.0.113.10" ]]
+ local 'message=   set dstaddr "203.0.113.10"'
+ echo -e '   set dstaddr "203.0.113.10"'
+ for object in "${restored_block[@]}"
+ message '   set action accept'
+ [[ -n    set action accept ]]
+ local 'message=   set action accept'
+ echo -e '   set action accept'
+ for object in "${restored_block[@]}"
+ message '   set logtraffic all'
+ [[ -n    set logtraffic all ]]
+ local 'message=   set logtraffic all'
+ echo -e '   set logtraffic all'
+ for object in "${restored_block[@]}"
+ message '  next'
+ [[ -n   next ]]
+ local 'message=  next'
+ echo -e '  next'
+ for object in "${restored_block[@]}"
+ message end
+ [[ -n end ]]
+ local message=end
+ echo -e end
+ newline
+ local count=1
+ (( i = 0 ))
+ (( i < count ))
+ echo
+ (( i++ ))
+ (( i < count ))
+ message 'JSON Object (output):'
+ [[ -n JSON Object (output): ]]
+ local 'message=JSON Object (output):'
+ echo -e 'JSON Object (output):'
+ jq -r .
+ [[ -n {
  "object": "config",
  "type": "firewall policy",
  "partner": false,
  "description": false,
  "items": [
    "set srcaddr \"10.10.10.10\""
  ],
  "others": [
    "edit 13",
    "set name \"Remote NAT\"",
    "set srcintf \"dmz\"",
    "set dstintf \"wan1\"",
    "set dstaddr \"203.0.113.10\"",
    "set action accept",
    "set logtraffic all"
  ],
  "group": "Unclassified"
} ]]
+ jq -r .
+ cat -n /var/folders/vp/4k9xy96d7zx8lhmgrr4khsj80000gn/T/tmp.90hwuJyGl8/fg-testing-config.list.objects
     1	{
     2	  "object": "config",
     3	  "type": "firewall policy",
     4	  "partner": false,
     5	  "description": false,
     6	  "items": [
     7	    "set srcaddr \"10.10.10.10\""
     8	  ],
     9	  "others": [
    10	    "edit 13",
    11	    "set name \"Remote NAT\"",
    12	    "set srcintf \"dmz\"",
    13	    "set dstintf \"wan1\"",
    14	    "set dstaddr \"203.0.113.10\"",
    15	    "set action accept",
    16	    "set logtraffic all"
    17	  ],
    18	  "group": "Unclassified"
    19	}
+ return 0
