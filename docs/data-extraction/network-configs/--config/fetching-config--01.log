$ bash -x scripts/network-configs.shell \
          --ips-list=./ips.list \
          --config=./configs/cisco/branch-isr-02.cfg \
          --output=./resources/branch-isr-02-multi.cfg \
          --verbose ;

+ set -euo pipefail
+ export LC_ALL=C
+ LC_ALL=C
++ mktemp -d
+ export TMP_DIR=/var/folders/vp/4k9xy96d7zx8lhmgrr4khsj80000gn/T/tmp.6luOayRXmo
+ TMP_DIR=/var/folders/vp/4k9xy96d7zx8lhmgrr4khsj80000gn/T/tmp.6luOayRXmo
+ trap '[[ -d "${TMP_DIR}" ]] && rm -rf "${TMP_DIR}"' EXIT
+ export 'nl=\n'
+ nl='\n'
+ alias display-help=display_help
+ alias new-line=newline
+ alias print-message=message
+ alias error-message=error_message
+ alias detect-vendor=detect_vendor
+ alias parse-cisco=main
+ [[ -z '' ]]
+ export script_name=scripts/network-configs.shell
+ script_name=scripts/network-configs.shell
+ [[ 4 -ge 1 ]]
+ [[ --ips-list=./ips.list =~ ^-*(h|help)$ ]]
+ newline
+ local count=1
+ (( i = 0 ))
+ (( i < count ))
+ echo

+ (( i++ ))
+ (( i < count ))
+ main --ips-list=./ips.list --config=./configs/cisco/branch-isr-02.cfg --output=./resources/branch-isr-02-multi.cfg --verbose
+ oIFS=' 	
'
+ for xitem in "${@}"
+ IFS==
+ read -r key value
++ echo -e --ips-list=./ips.list
++ sed -e '1s|^\(-\)\{1,\}||'
+ [[ ips-list =~ ^(ips-list|i)$ ]]
+ local target_addresses=./ips.list
+ [[ ips-list =~ ^(config|c)$ ]]
+ [[ ips-list =~ ^(search|s)$ ]]
+ [[ ips-list =~ ^(location|l)$ ]]
+ [[ ips-list =~ ^(output|o)$ ]]
+ [[ ips-list == \h\e\l\p ]]
+ [[ ips-list == \d\e\b\u\g ]]
+ [[ ips-list == \d\r\y\-\r\u\n ]]
+ [[ ips-list == \v\e\r\b\o\s\e ]]
+ for xitem in "${@}"
+ IFS==
+ read -r key value
++ echo -e --config=./configs/cisco/branch-isr-02.cfg
++ sed -e '1s|^\(-\)\{1,\}||'
+ [[ config =~ ^(ips-list|i)$ ]]
+ [[ config =~ ^(config|c)$ ]]
+ local source_config=./configs/cisco/branch-isr-02.cfg
+ [[ config =~ ^(search|s)$ ]]
+ [[ config =~ ^(location|l)$ ]]
+ [[ config =~ ^(output|o)$ ]]
+ [[ config == \h\e\l\p ]]
+ [[ config == \d\e\b\u\g ]]
+ [[ config == \d\r\y\-\r\u\n ]]
+ [[ config == \v\e\r\b\o\s\e ]]
+ for xitem in "${@}"
+ IFS==
+ read -r key value
++ echo -e --output=./resources/branch-isr-02-multi.cfg
++ sed -e '1s|^\(-\)\{1,\}||'
+ [[ output =~ ^(ips-list|i)$ ]]
+ [[ output =~ ^(config|c)$ ]]
+ [[ output =~ ^(search|s)$ ]]
+ [[ output =~ ^(location|l)$ ]]
+ [[ output =~ ^(output|o)$ ]]
+ local output_config=./resources/branch-isr-02-multi.cfg
+ [[ output == \h\e\l\p ]]
+ [[ output == \d\e\b\u\g ]]
+ [[ output == \d\r\y\-\r\u\n ]]
+ [[ output == \v\e\r\b\o\s\e ]]
+ for xitem in "${@}"
+ IFS==
+ read -r key value
++ echo -e --verbose
++ sed -e '1s|^\(-\)\{1,\}||'
+ [[ verbose =~ ^(ips-list|i)$ ]]
+ [[ verbose =~ ^(config|c)$ ]]
+ [[ verbose =~ ^(search|s)$ ]]
+ [[ verbose =~ ^(location|l)$ ]]
+ [[ verbose =~ ^(output|o)$ ]]
+ [[ verbose == \h\e\l\p ]]
+ [[ verbose == \d\e\b\u\g ]]
+ [[ verbose == \d\r\y\-\r\u\n ]]
+ [[ verbose == \v\e\r\b\o\s\e ]]
+ local verbose=true
+ IFS=' 	
'
+ [[ -z '' ]]
+ local script_helper=false
+ [[ -z ./resources/branch-isr-02-multi.cfg ]]
+ [[ ./resources/branch-isr-02-multi.cfg =~ ^(/|\./?$|)$ ]]
+ [[ ! -d ./resources/branch-isr-02-multi.cfg ]]
+ mkdir -p ./resources/branch-isr-02-multi.cfg
+ [[ -z '' ]]
+ debug=false
+ [[ -z '' ]]
+ dry_run=false
+ [[ -z true ]]
+ [[ false == true ]]
+ configs_listing=()
+ declare -a configs_listing
+ local action_class=unknown
+ [[ -n ./configs/cisco/branch-isr-02.cfg ]]
+ [[ -f ./configs/cisco/branch-isr-02.cfg ]]
+ configs_listing=("${source_config}")
+ action_class=config
+ [[ -z '' ]]
+ [[ -n '' ]]
+ [[ -z '' ]]
+ [[ -z ./configs/cisco/branch-isr-02.cfg ]]
+ [[ -z ./ips.list ]]
+ target_addresses_source=()
+ declare -a target_addresses_source
+ [[ -f ./ips.list ]]
+ mapfile -t target_addresses_source
++ tr -d '\r'
++ tr ' \t,;:|' '\n'
++ grep -v '^\s*$'
++ sort -t . -k1,1n -k2,2n -k3,3n -k4,4n -u
+ [[ true == true ]]
+ message 'Loaded (default) IPs addresses (count): 17'
+ [[ -n Loaded (default) IPs addresses (count): 17 ]]
+ local 'message=Loaded (default) IPs addresses (count): 17'
+ echo -e 'Loaded (default) IPs addresses (count): 17'
Loaded (default) IPs addresses (count): 17
+ newline
+ local count=1
+ (( i = 0 ))
+ (( i < count ))
+ echo

+ (( i++ ))
+ (( i < count ))
+ for ip in "${target_addresses_source[@]}"
+ message '  - 10.0.0.1'
+ [[ -n   - 10.0.0.1 ]]
+ local 'message=  - 10.0.0.1'
+ echo -e '  - 10.0.0.1'
  - 10.0.0.1
+ for ip in "${target_addresses_source[@]}"
+ message '  - 10.0.1.2'
+ [[ -n   - 10.0.1.2 ]]
+ local 'message=  - 10.0.1.2'
+ echo -e '  - 10.0.1.2'
  - 10.0.1.2
+ for ip in "${target_addresses_source[@]}"
+ message '  - 10.0.2.3'
+ [[ -n   - 10.0.2.3 ]]
+ local 'message=  - 10.0.2.3'
+ echo -e '  - 10.0.2.3'
  - 10.0.2.3
+ for ip in "${target_addresses_source[@]}"
+ message '  - 10.10.10.10'
+ [[ -n   - 10.10.10.10 ]]
+ local 'message=  - 10.10.10.10'
+ echo -e '  - 10.10.10.10'
  - 10.10.10.10
+ for ip in "${target_addresses_source[@]}"
+ message '  - 172.16.0.5'
+ [[ -n   - 172.16.0.5 ]]
+ local 'message=  - 172.16.0.5'
+ echo -e '  - 172.16.0.5'
  - 172.16.0.5
+ for ip in "${target_addresses_source[@]}"
+ message '  - 172.16.1.6'
+ [[ -n   - 172.16.1.6 ]]
+ local 'message=  - 172.16.1.6'
+ echo -e '  - 172.16.1.6'
  - 172.16.1.6
+ for ip in "${target_addresses_source[@]}"
+ message '  - 172.18.1.20'
+ [[ -n   - 172.18.1.20 ]]
+ local 'message=  - 172.18.1.20'
+ echo -e '  - 172.18.1.20'
  - 172.18.1.20
+ for ip in "${target_addresses_source[@]}"
+ message '  - 172.31.255.254'
+ [[ -n   - 172.31.255.254 ]]
+ local 'message=  - 172.31.255.254'
+ echo -e '  - 172.31.255.254'
  - 172.31.255.254
+ for ip in "${target_addresses_source[@]}"
+ message '  - 192.0.2.50'
+ [[ -n   - 192.0.2.50 ]]
+ local 'message=  - 192.0.2.50'
+ echo -e '  - 192.0.2.50'
  - 192.0.2.50
+ for ip in "${target_addresses_source[@]}"
+ message '  - 192.168.0.1'
+ [[ -n   - 192.168.0.1 ]]
+ local 'message=  - 192.168.0.1'
+ echo -e '  - 192.168.0.1'
  - 192.168.0.1
+ for ip in "${target_addresses_source[@]}"
+ message '  - 192.168.0.100'
+ [[ -n   - 192.168.0.100 ]]
+ local 'message=  - 192.168.0.100'
+ echo -e '  - 192.168.0.100'
  - 192.168.0.100
+ for ip in "${target_addresses_source[@]}"
+ message '  - 192.168.1.10'
+ [[ -n   - 192.168.1.10 ]]
+ local 'message=  - 192.168.1.10'
+ echo -e '  - 192.168.1.10'
  - 192.168.1.10
+ for ip in "${target_addresses_source[@]}"
+ message '  - 192.168.1.11'
+ [[ -n   - 192.168.1.11 ]]
+ local 'message=  - 192.168.1.11'
+ echo -e '  - 192.168.1.11'
  - 192.168.1.11
+ for ip in "${target_addresses_source[@]}"
+ message '  - 192.168.2.12'
+ [[ -n   - 192.168.2.12 ]]
+ local 'message=  - 192.168.2.12'
+ echo -e '  - 192.168.2.12'
  - 192.168.2.12
+ for ip in "${target_addresses_source[@]}"
+ message '  - 192.168.100.100'
+ [[ -n   - 192.168.100.100 ]]
+ local 'message=  - 192.168.100.100'
+ echo -e '  - 192.168.100.100'
  - 192.168.100.100
+ for ip in "${target_addresses_source[@]}"
+ message '  - 198.51.100.75'
+ [[ -n   - 198.51.100.75 ]]
+ local 'message=  - 198.51.100.75'
+ echo -e '  - 198.51.100.75'
  - 198.51.100.75
+ for ip in "${target_addresses_source[@]}"
+ message '  - 203.0.113.25'
+ [[ -n   - 203.0.113.25 ]]
+ local 'message=  - 203.0.113.25'
+ echo -e '  - 203.0.113.25'
  - 203.0.113.25
+ newline
+ local count=1
+ (( i = 0 ))
+ (( i < count ))
+ echo

+ (( i++ ))
+ (( i < count ))
++ IFS=,
++ echo -e 10.0.0.1,10.0.1.2,10.0.2.3,10.10.10.10,172.16.0.5,172.16.1.6,172.18.1.20,172.31.255.254,192.0.2.50,192.168.0.1,192.168.0.100,192.168.1.10,192.168.1.11,192.168.2.12,192.168.100.100,198.51.100.75,203.0.113.25
+ target_addresses=10.0.0.1,10.0.1.2,10.0.2.3,10.10.10.10,172.16.0.5,172.16.1.6,172.18.1.20,172.31.255.254,192.0.2.50,192.168.0.1,192.168.0.100,192.168.1.10,192.168.1.11,192.168.2.12,192.168.100.100,198.51.100.75,203.0.113.25
+ [[ true == true ]]
+ message 'Search Pattern: [ 10.0.0.1,10.0.1.2,10.0.2.3,10.10.10.10,172.16.0.5,172.16.1.6,172.18.1.20,172.31.255.254,192.0.2.50,192.168.0.1,192.168.0.100,192.168.1.10,192.168.1.11,192.168.2.12,192.168.100.100,198.51.100.75,203.0.113.25 ]'
+ [[ -n Search Pattern: [ 10.0.0.1,10.0.1.2,10.0.2.3,10.10.10.10,172.16.0.5,172.16.1.6,172.18.1.20,172.31.255.254,192.0.2.50,192.168.0.1,192.168.0.100,192.168.1.10,192.168.1.11,192.168.2.12,192.168.100.100,198.51.100.75,203.0.113.25 ] ]]
+ local 'message=Search Pattern: [ 10.0.0.1,10.0.1.2,10.0.2.3,10.10.10.10,172.16.0.5,172.16.1.6,172.18.1.20,172.31.255.254,192.0.2.50,192.168.0.1,192.168.0.100,192.168.1.10,192.168.1.11,192.168.2.12,192.168.100.100,198.51.100.75,203.0.113.25 ]'
+ echo -e 'Search Pattern: [ 10.0.0.1,10.0.1.2,10.0.2.3,10.10.10.10,172.16.0.5,172.16.1.6,172.18.1.20,172.31.255.254,192.0.2.50,192.168.0.1,192.168.0.100,192.168.1.10,192.168.1.11,192.168.2.12,192.168.100.100,198.51.100.75,203.0.113.25 ]'
Search Pattern: [ 10.0.0.1,10.0.1.2,10.0.2.3,10.10.10.10,172.16.0.5,172.16.1.6,172.18.1.20,172.31.255.254,192.0.2.50,192.168.0.1,192.168.0.100,192.168.1.10,192.168.1.11,192.168.2.12,192.168.100.100,198.51.100.75,203.0.113.25 ]
+ newline
+ local count=1
+ (( i = 0 ))
+ (( i < count ))
+ echo

+ (( i++ ))
+ (( i < count ))
+ [[ -n '' ]]
+ [[ 1 -eq 0 ]]
+ [[ -n '' ]]
+ [[ -n '' ]]
+ [[ 1 -eq 0 ]]
+ for target_config in "${configs_listing[@]}"
+ [[ ! -f ./configs/cisco/branch-isr-02.cfg ]]
+ set +e
+ detect_vendor ./configs/cisco/branch-isr-02.cfg
+ local config_file=./configs/cisco/branch-isr-02.cfg
+ local 'fortinet_pattern=fortinet|fortigate'
+ local 'cisco_pattern=\basa\b|cisco ios|cisco adaptive|^interface\b|^object\b'
+ grep -qiE 'fortinet|fortigate' ./configs/cisco/branch-isr-02.cfg
+ grep -qiE '\basa\b|cisco ios|cisco adaptive|^interface\b|^object\b' ./configs/cisco/branch-isr-02.cfg
+ return 2
+ local vendor_code=2
+ set -e
+ case "${vendor_code}" in
+ target_platform=cisco
+ [[ true == true ]]
+ message 'Parsing [ cisco ] configs (by: config): '
+ [[ -n Parsing [ cisco ] configs (by: config):  ]]
+ local 'message=Parsing [ cisco ] configs (by: config): '
+ echo -e 'Parsing [ cisco ] configs (by: config): '
Parsing [ cisco ] configs (by: config): 
+ [[ -n ./resources/branch-isr-02-multi.cfg ]]
+ base_output=./resources/branch-isr-02-multi.cfg
++ echo -e ./configs/cisco/branch-isr-02.cfg
++ sed 's|^\./||'
+ rel_path=configs/cisco/branch-isr-02.cfg
+ target_output=./resources/branch-isr-02-multi.cfg/configs/cisco/branch-isr-02.cfg
+ execute=('./scripts/extract-configs.shell' '--ips-list=10.0.0.1,10.0.1.2,10.0.2.3,10.10.10.10,172.16.0.5,172.16.1.6,172.18.1.20,172.31.255.254,192.0.2.50,192.168.0.1,192.168.0.100,192.168.1.10,192.168.1.11,192.168.2.12,192.168.100.100,198.51.100.75,203.0.113.25' '--config=./configs/cisco/branch-isr-02.cfg' '--output=./resources/branch-isr-02-multi.cfg/configs/cisco/branch-isr-02.cfg')
+ declare -a execute
+ [[ true == true ]]
+ execute+=(--verbose)
++ which bash
+ /usr/local/bin/bash ./scripts/extract-configs.shell --ips-list=10.0.0.1,10.0.1.2,10.0.2.3,10.10.10.10,172.16.0.5,172.16.1.6,172.18.1.20,172.31.255.254,192.0.2.50,192.168.0.1,192.168.0.100,192.168.1.10,192.168.1.11,192.168.2.12,192.168.100.100,198.51.100.75,203.0.113.25 --config=./configs/cisco/branch-isr-02.cfg --output=./resources/branch-isr-02-multi.cfg/configs/cisco/branch-isr-02.cfg --verbose
+ [[ true == true ]]
+ message 'Configuration File [ ./resources/branch-isr-02-multi.cfg/configs/cisco/branch-isr-02.cfg ]'
+ [[ -n Configuration File [ ./resources/branch-isr-02-multi.cfg/configs/cisco/branch-isr-02.cfg ] ]]
+ local 'message=Configuration File [ ./resources/branch-isr-02-multi.cfg/configs/cisco/branch-isr-02.cfg ]'
+ echo -e 'Configuration File [ ./resources/branch-isr-02-multi.cfg/configs/cisco/branch-isr-02.cfg ]'
Configuration File [ ./resources/branch-isr-02-multi.cfg/configs/cisco/branch-isr-02.cfg ]
+ newline
+ local count=1
+ (( i = 0 ))
+ (( i < count ))
+ echo

+ (( i++ ))
+ (( i < count ))
+ cat -n ./resources/branch-isr-02-multi.cfg/configs/cisco/branch-isr-02.cfg
     1	hostname branch-isr-02
     2	
     3	interface GigabitEthernet0/0/0
     4	 ip address 172.16.1.6 255.255.255.0
     5	 description ISP uplink
     6	
     7	interface GigabitEthernet0/0/1
     8	 ip address 192.168.2.12 255.255.255.0
     9	 description Workstation LAN
    10	
    11	interface GigabitEthernet0/0/2
    12	 ip address 10.0.2.3 255.255.255.0
    13	 description Dev VLAN
    14	
    15	object network BlackWidow-Core
    16	 host 172.16.1.6
    17	 description Branch router uplink NAT
    18	
    19	object network Hydra-Link
    20	 host 198.51.100.75
    21	 description Branch NAT egress
    22	
    23	object-group network Hydra-Edge
    24	 description Remote site uplink
    25	 network-object host 192.168.2.12
    26	 network-object host 198.51.100.75
    27	
    28	object network Panther-Gateway
    29	 host 10.0.2.3
    30	 description Secure outbound concentrator
    31	
    32	object-group network Lantern-DMZ
    33	 description Protected but public-facing zone
    34	 network-object host 172.18.1.20
    35	 network-object host 192.168.1.11
    36	
    37	access-list OUTSIDE extended permit ip host 10.0.2.3 any
    38	
    39	access-list OUTSIDE extended permit ip any host 172.16.1.6
    40	
    41	access-list OUTSIDE extended permit ip any host 198.51.100.75
    42	
+ newline
+ local count=1
+ (( i = 0 ))
+ (( i < count ))
+ echo

+ (( i++ ))
+ (( i < count ))
+ tree ./resources/branch-isr-02-multi.cfg
./resources/branch-isr-02-multi.cfg
`-- configs
    `-- cisco
        `-- branch-isr-02.cfg

3 directories, 1 file
+ newline
+ local count=1
+ (( i = 0 ))
+ (( i < count ))
+ echo

+ (( i++ ))
+ (( i < count ))
+ return 0
+ result=0
+ exit 0
+ [[ -d /var/folders/vp/4k9xy96d7zx8lhmgrr4khsj80000gn/T/tmp.6luOayRXmo ]]
+ rm -rf /var/folders/vp/4k9xy96d7zx8lhmgrr4khsj80000gn/T/tmp.6luOayRXmo

$ bash scripts/network-configs.shell \
       --ips-list=ips.list \
       --config=./configs/cisco/branch-isr-02.cfg \
       --output=./resources/branch-isr-02-multi.cfg \
       --verbose ;

Loaded (default) IPs addresses (count): 17

  - 10.0.0.1
  - 10.0.1.2
  - 10.0.2.3
  - 10.10.10.10
  - 172.16.0.5
  - 172.16.1.6
  - 172.18.1.20
  - 172.31.255.254
  - 192.0.2.50
  - 192.168.0.1
  - 192.168.0.100
  - 192.168.1.10
  - 192.168.1.11
  - 192.168.2.12
  - 192.168.100.100
  - 198.51.100.75
  - 203.0.113.25

Search Pattern: [ 10.0.0.1,10.0.1.2,10.0.2.3,10.10.10.10,172.16.0.5,172.16.1.6,172.18.1.20,172.31.255.254,192.0.2.50,192.168.0.1,192.168.0.100,192.168.1.10,192.168.1.11,192.168.2.12,192.168.100.100,198.51.100.75,203.0.113.25 ]

Parsing [ cisco ] configs (by: config): 
Configuration File [ ./resources/branch-isr-02-multi.cfg/configs/cisco/branch-isr-02.cfg ]

     1	hostname branch-isr-02
     2	
     3	interface GigabitEthernet0/0/0
     4	 ip address 172.16.1.6 255.255.255.0
     5	 description ISP uplink
     6	
     7	interface GigabitEthernet0/0/1
     8	 ip address 192.168.2.12 255.255.255.0
     9	 description Workstation LAN
    10	
    11	interface GigabitEthernet0/0/2
    12	 ip address 10.0.2.3 255.255.255.0
    13	 description Dev VLAN
    14	
    15	object network BlackWidow-Core
    16	 host 172.16.1.6
    17	 description Branch router uplink NAT
    18	
    19	object network Hydra-Link
    20	 host 198.51.100.75
    21	 description Branch NAT egress
    22	
    23	object-group network Hydra-Edge
    24	 description Remote site uplink
    25	 network-object host 192.168.2.12
    26	 network-object host 198.51.100.75
    27	
    28	object network Panther-Gateway
    29	 host 10.0.2.3
    30	 description Secure outbound concentrator
    31	
    32	object-group network Lantern-DMZ
    33	 description Protected but public-facing zone
    34	 network-object host 172.18.1.20
    35	 network-object host 192.168.1.11
    36	
    37	access-list OUTSIDE extended permit ip host 10.0.2.3 any
    38	
    39	access-list OUTSIDE extended permit ip any host 172.16.1.6
    40	
    41	access-list OUTSIDE extended permit ip any host 198.51.100.75
    42	

./resources/branch-isr-02-multi.cfg
`-- configs
    `-- cisco
        `-- branch-isr-02.cfg

3 directories, 1 file
