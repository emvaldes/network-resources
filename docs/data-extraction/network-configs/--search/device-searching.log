$ bash -x ./scripts/network-configs.shell \
          --ip-addr="198.51.100.75,203.0.113.10" \
          --search="branch-isr-02.cfg,fg-lab-test-fw.cfg,edge-router-01.cfg" \
          --output=./.outputs \
          --verbose ;

+ set -euo pipefail
+ export LC_ALL=C
+ LC_ALL=C
++ mktemp -d
+ export TMP_DIR=/var/folders/vp/4k9xy96d7zx8lhmgrr4khsj80000gn/T/tmp.bZ3R1qpENN
+ TMP_DIR=/var/folders/vp/4k9xy96d7zx8lhmgrr4khsj80000gn/T/tmp.bZ3R1qpENN
+ trap '[[ -d "${TMP_DIR}" ]] && rm -rf "${TMP_DIR}"' EXIT
+ export 'nl=\n'
+ nl='\n'
+ alias display-help=display_help
+ alias new-line=newline
+ alias print-message=message
+ alias detect-vendor=detect_vendor
+ alias parse-cisco=main
+ [[ -z '' ]]
+ export script_name=./scripts/network-configs.shell
+ script_name=./scripts/network-configs.shell
+ [[ 4 -ge 1 ]]
+ [[ --ip-addr=198.51.100.75,203.0.113.10 =~ ^-*(h|help)$ ]]
+ main --ip-addr=198.51.100.75,203.0.113.10 --search=branch-isr-02.cfg,fg-lab-test-fw.cfg,edge-router-01.cfg --output=./.outputs --verbose
+ oIFS='
'
+ for xitem in "${@}"
+ IFS==
+ read -r key value
++ echo -e --ip-addr=198.51.100.75,203.0.113.10
++ sed -e '1s|^\(-\)\{1,\}||'
+ [[ ip-addr =~ ^(ip-addr|i)$ ]]
+ export search_pattern=198.51.100.75,203.0.113.10
+ search_pattern=198.51.100.75,203.0.113.10
+ [[ ip-addr =~ ^(config|c)$ ]]
+ [[ ip-addr =~ ^(search|s)$ ]]
+ [[ ip-addr =~ ^(location|l)$ ]]
+ [[ ip-addr =~ ^(output|o)$ ]]
+ [[ ip-addr == \h\e\l\p ]]
+ [[ ip-addr == \d\e\b\u\g ]]
+ [[ ip-addr == \d\r\y\-\r\u\n ]]
+ [[ ip-addr == \v\e\r\b\o\s\e ]]
+ for xitem in "${@}"
+ IFS==
+ read -r key value
++ echo -e --search=branch-isr-02.cfg,fg-lab-test-fw.cfg,edge-router-01.cfg
++ sed -e '1s|^\(-\)\{1,\}||'
+ [[ search =~ ^(ip-addr|i)$ ]]
+ [[ search =~ ^(config|c)$ ]]
+ [[ search =~ ^(search|s)$ ]]
+ export search_configs=branch-isr-02.cfg,fg-lab-test-fw.cfg,edge-router-01.cfg
+ search_configs=branch-isr-02.cfg,fg-lab-test-fw.cfg,edge-router-01.cfg
+ [[ search =~ ^(location|l)$ ]]
+ [[ search =~ ^(output|o)$ ]]
+ [[ search == \h\e\l\p ]]
+ [[ search == \d\e\b\u\g ]]
+ [[ search == \d\r\y\-\r\u\n ]]
+ [[ search == \v\e\r\b\o\s\e ]]
+ for xitem in "${@}"
+ IFS==
+ read -r key value
++ echo -e --output=./.outputs
++ sed -e '1s|^\(-\)\{1,\}||'
+ [[ output =~ ^(ip-addr|i)$ ]]
+ [[ output =~ ^(config|c)$ ]]
+ [[ output =~ ^(search|s)$ ]]
+ [[ output =~ ^(location|l)$ ]]
+ [[ output =~ ^(output|o)$ ]]
+ export output_config=./.outputs
+ output_config=./.outputs
+ [[ output == \h\e\l\p ]]
+ [[ output == \d\e\b\u\g ]]
+ [[ output == \d\r\y\-\r\u\n ]]
+ [[ output == \v\e\r\b\o\s\e ]]
+ for xitem in "${@}"
+ IFS==
+ read -r key value
++ echo -e --verbose
++ sed -e '1s|^\(-\)\{1,\}||'
+ [[ verbose =~ ^(ip-addr|i)$ ]]
+ [[ verbose =~ ^(config|c)$ ]]
+ [[ verbose =~ ^(search|s)$ ]]
+ [[ verbose =~ ^(location|l)$ ]]
+ [[ verbose =~ ^(output|o)$ ]]
+ [[ verbose == \h\e\l\p ]]
+ [[ verbose == \d\e\b\u\g ]]
+ [[ verbose == \d\r\y\-\r\u\n ]]
+ [[ verbose == \v\e\r\b\o\s\e ]]
+ local verbose=true
+ IFS='
'
+ [[ -z '' ]]
+ script_helper=false
+ [[ -z '' ]]
+ debug=false
+ [[ -z '' ]]
+ dry_run=false
+ [[ -z true ]]
+ [[ false == true ]]
+ configs_listing=()
+ declare -a configs_listing
+ [[ -z 198.51.100.75,203.0.113.10 ]]
+ configs_listing=()
+ [[ -n '' ]]
+ [[ -n branch-isr-02.cfg,fg-lab-test-fw.cfg,edge-router-01.cfg ]]
+ IFS=,
+ read -r -a search_items
+ found_configs=()
+ for item in "${search_items[@]}"
++ find . -type f -name branch-isr-02.cfg
++ head -n 1
+ result=./configs/cisco/branch-isr-02.cfg
+ [[ -n ./configs/cisco/branch-isr-02.cfg ]]
+ found_configs+=("$result")
+ for item in "${search_items[@]}"
++ find . -type f -name fg-lab-test-fw.cfg
++ head -n 1
+ result=./configs/fortinet/fg-lab-test-fw.cfg
+ [[ -n ./configs/fortinet/fg-lab-test-fw.cfg ]]
+ found_configs+=("$result")
+ for item in "${search_items[@]}"
++ find . -type f -name edge-router-01.cfg
++ head -n 1
+ result=
+ [[ -n '' ]]
+ [[ 2 -gt 0 ]]
+ configs_listing=("${found_configs[@]}")
+ [[ -n '' ]]
+ [[ 2 -eq 0 ]]
+ for source_config in "${configs_listing[@]}"
+ [[ ! -f ./configs/cisco/branch-isr-02.cfg ]]
+ set +e
+ detect_vendor ./configs/cisco/branch-isr-02.cfg
+ local config_file=./configs/cisco/branch-isr-02.cfg
+ local 'fortinet_pattern=fortinet|fortigate'
+ local 'cisco_pattern=\basa\b|cisco ios|cisco adaptive|^interface\b|^object\b'
+ grep -qiE 'fortinet|fortigate' ./configs/cisco/branch-isr-02.cfg
+ grep -qiE '\basa\b|cisco ios|cisco adaptive|^interface\b|^object\b' ./configs/cisco/branch-isr-02.cfg
+ return 2
+ local vendor_code=2
+ set -e
+ case "${vendor_code}" in
+ target_platform=cisco
+ [[ -n ./.outputs ]]
+ base_output=./.outputs
++ echo ./configs/cisco/branch-isr-02.cfg
++ sed 's|^\./||'
+ rel_path=configs/cisco/branch-isr-02.cfg
+ target_output=./.outputs/configs/cisco/branch-isr-02.cfg
++ dirname ./.outputs/configs/cisco/branch-isr-02.cfg
+ local output_dir=./.outputs/configs/cisco
+ [[ ! -d ./.outputs/configs/cisco ]]
+ mkdir -p ./.outputs/configs/cisco
+ execute=('./scripts/extract-configs.shell' '--ip-addr=198.51.100.75,203.0.113.10' '--config=./configs/cisco/branch-isr-02.cfg' '--output=./.outputs/configs/cisco/branch-isr-02.cfg')
+ declare -a execute
+ [[ true == true ]]
+ execute+=(--verbose)
++ which bash
+ /usr/local/bin/bash ./scripts/extract-configs.shell --ip-addr=198.51.100.75,203.0.113.10 --config=./configs/cisco/branch-isr-02.cfg --output=./.outputs/configs/cisco/branch-isr-02.cfg --verbose
+ [[ true == true ]]
+ newline 1
+ local count=1
+ (( i = 0 ))
+ (( i < count ))
+ echo

+ (( i++ ))
+ (( i < count ))
+ cat -n ./.outputs/configs/cisco/branch-isr-02.cfg
     1	hostname branch-isr-02
     2
     3	object network Hydra-Link
     4	 host 198.51.100.75
     5	 description Branch NAT egress
     6
     7	object-group network Hydra-Edge
     8	 description Remote site uplink
     9	 network-object host 192.168.2.12
    10	 network-object host 198.51.100.75
    11
    12	access-list OUTSIDE extended permit ip any host 198.51.100.75
    13
+ newline 2
+ local count=2
+ (( i = 0 ))
+ (( i < count ))
+ echo

+ (( i++ ))
+ (( i < count ))
+ echo

+ (( i++ ))
+ (( i < count ))
+ ls -al ./.outputs
total 0
drwxr-xr-x   3 emvaldes  staff   96 May 24 00:55 .
drwxr-xr-x@ 18 emvaldes  staff  576 May 24 00:55 ..
drwxr-xr-x   3 emvaldes  staff   96 May 24 00:55 configs
+ newline
+ local count=1
+ (( i = 0 ))
+ (( i < count ))
+ echo

+ (( i++ ))
+ (( i < count ))
+ for source_config in "${configs_listing[@]}"
+ [[ ! -f ./configs/fortinet/fg-lab-test-fw.cfg ]]
+ set +e
+ detect_vendor ./configs/fortinet/fg-lab-test-fw.cfg
+ local config_file=./configs/fortinet/fg-lab-test-fw.cfg
+ local 'fortinet_pattern=fortinet|fortigate'
+ local 'cisco_pattern=\basa\b|cisco ios|cisco adaptive|^interface\b|^object\b'
+ grep -qiE 'fortinet|fortigate' ./configs/fortinet/fg-lab-test-fw.cfg
+ return 1
+ local vendor_code=1
+ set -e
+ case "${vendor_code}" in
+ target_platform=fortinet
+ [[ -n ./.outputs ]]
+ base_output=./.outputs
++ echo ./configs/fortinet/fg-lab-test-fw.cfg
++ sed 's|^\./||'
+ rel_path=configs/fortinet/fg-lab-test-fw.cfg
+ target_output=./.outputs/configs/fortinet/fg-lab-test-fw.cfg
++ dirname ./.outputs/configs/fortinet/fg-lab-test-fw.cfg
+ local output_dir=./.outputs/configs/fortinet
+ [[ ! -d ./.outputs/configs/fortinet ]]
+ mkdir -p ./.outputs/configs/fortinet
+ execute=('./scripts/extract-configs.shell' '--ip-addr=198.51.100.75,203.0.113.10' '--config=./configs/fortinet/fg-lab-test-fw.cfg' '--output=./.outputs/configs/fortinet/fg-lab-test-fw.cfg')
+ declare -a execute
+ [[ true == true ]]
+ execute+=(--verbose)
++ which bash
+ /usr/local/bin/bash ./scripts/extract-configs.shell --ip-addr=198.51.100.75,203.0.113.10 --config=./configs/fortinet/fg-lab-test-fw.cfg --output=./.outputs/configs/fortinet/fg-lab-test-fw.cfg --verbose
+ [[ true == true ]]
+ newline 1
+ local count=1
+ (( i = 0 ))
+ (( i < count ))
+ echo

+ (( i++ ))
+ (( i < count ))
+ cat -n ./.outputs/configs/fortinet/fg-lab-test-fw.cfg
     1	#hostname="fg-lab-test-fw"
     2	#model="FortiGate-40F"
     3
     4	config system interface
     5	 edit "wan1"
     6	  set ip 198.51.100.75 255.255.255.0
     7	  set alias "Branch ISP"
     8	 next
     9	end
    10
    11	config firewall address
    12	 edit "Branch-Public"
    13	  set subnet 198.51.100.75 255.255.255.255
    14	  set comment "Branch NAT"
    15	 next
    16	end
    17
+ newline 2
+ local count=2
+ (( i = 0 ))
+ (( i < count ))
+ echo

+ (( i++ ))
+ (( i < count ))
+ echo

+ (( i++ ))
+ (( i < count ))
+ ls -al ./.outputs
total 0
drwxr-xr-x   3 emvaldes  staff   96 May 24 00:55 .
drwxr-xr-x@ 18 emvaldes  staff  576 May 24 00:55 ..
drwxr-xr-x   4 emvaldes  staff  128 May 24 00:55 configs
+ newline
+ local count=1
+ (( i = 0 ))
+ (( i < count ))
+ echo

+ (( i++ ))
+ (( i < count ))
+ return 0
+ result=0
+ exit 0
+ [[ -d /var/folders/vp/4k9xy96d7zx8lhmgrr4khsj80000gn/T/tmp.bZ3R1qpENN ]]
+ rm -rf /var/folders/vp/4k9xy96d7zx8lhmgrr4khsj80000gn/T/tmp.bZ3R1qpENN

$ cat ./.outputs/configs/cisco/branch-isr-02.cfg ;

hostname branch-isr-02

object network Hydra-Link
 host 198.51.100.75
 description Branch NAT egress

object-group network Hydra-Edge
 description Remote site uplink
 network-object host 192.168.2.12
 network-object host 198.51.100.75

access-list OUTSIDE extended permit ip any host 198.51.100.75

$ cat ./.outputs/configs/fortinet/fg-lab-test-fw.cfg ;

#hostname="fg-lab-test-fw"
#model="FortiGate-40F"

config system interface
 edit "wan1"
  set ip 198.51.100.75 255.255.255.0
  set alias "Branch ISP"
 next
end

config firewall address
 edit "Branch-Public"
  set subnet 198.51.100.75 255.255.255.255
  set comment "Branch NAT"
 next
end
